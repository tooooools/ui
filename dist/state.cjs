"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});function a(i,t,s,e){this.fn=t,this.ctx=s||null,this.owner=i,this.once=!!e}function c(i,t){t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),t.ctx=t.fn=t.owner=null,t===i._first&&(i._first=t.next),t===i._last&&(i._last=t.prev)}class f{constructor(){this._first=this._last=null}dispatch(t,s,e,r,l){let u=this._first;for(;u;)u.fn.call(u.ctx,t,s,e,r,l),u.once&&this.unsubscribe(u),u=u.next}subscribe(t,s,e){const r=new a(this,t,s,e);return this._first?(this._last.next=r,r.prev=this._last,this._last=r):(this._first=r,this._last=r),r}subscribeOnce(t,s){return this.subscribe(t,s,!0)}unsubscribe(t,s){if(t instanceof a)return c(this,t);s||(s=null);let e=this._first;for(;e;)e.fn===t&&e.ctx===s&&c(this,e),e=e.next}unsubscribeAll(){let t=this._first;for(this._first=this._last=null;t;)c(this,t),t=t.next}}function g(){return new f}class o extends f{constructor(t){super(),this.current=t}set(){throw new Error("Cannot set a different value for a Readable Signal. Use Writable instead")}get(){return this.current}}function _(i){return new o(i)}class b extends o{set(t,s){if(!s&&this.current===t)return;this.previous=this.current,this.current=t;let e=this._first;for(;e;)e.fn.call(e.ctx,this.current,this.previous),e.once&&this.unsubscribe(e),e=e.next}update(t,s){const e=t(this.current);this.set(e!==void 0?e:this.current,s)}}function d(i){return new b(i)}function h(i,t){const s=new b,e=s.set.bind(s);delete s.set;const r=Array.isArray(i);let l=r?new Array(i.length):null;if(r)for(let n=0,w=i.length;n<w;n++)l[n]=i[n].current,i[n].subscribe(function(p){l[n]=p,u()});else l=i.current,i.subscribe(function(n){l=n,u()});u();function u(){const n=t(l);n&&n.then?n.then(e):e(n)}return s}const x=i=>h(i,t=>!t);exports.d=h;exports.derived=h;exports.n=x;exports.not=x;exports.r=_;exports.readable=_;exports.signal=g;exports.w=d;exports.writable=d;
