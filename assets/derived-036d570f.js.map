{"version":3,"file":"derived-036d570f.js","sources":["../../lib/state/derived.js"],"sourcesContent":["import { Writable } from './writable'\n\nfunction derived (observables, cb) {\n  const value = new Writable()\n\n  const setValue = value.set.bind(value)\n  delete value.set\n\n  const isArray = Array.isArray(observables)\n  let values = isArray ? (new Array(observables.length)) : null\n\n  if (isArray) {\n    for (let i = 0, l = observables.length; i < l; i++) {\n      values[i] = observables[i].current\n      observables[i].subscribe(function (v) {\n        values[i] = v\n        derive()\n      })\n    }\n  } else {\n    values = observables.current\n    observables.subscribe(function (v) {\n      values = v\n      derive()\n    })\n  }\n\n  derive()\n\n  function derive () {\n    const result = cb(values)\n    if (result && result.then) result.then(setValue)\n    else setValue(result)\n  }\n\n  return value\n}\n\nexport default derived\n"],"names":["derived","observables","cb","value","Writable","setValue","isArray","values","i","l","v","derive","result"],"mappings":"yCAEA,SAASA,EAASC,EAAaC,EAAI,CACjC,MAAMC,EAAQ,IAAIC,EAEZC,EAAWF,EAAM,IAAI,KAAKA,CAAK,EACrC,OAAOA,EAAM,IAEb,MAAMG,EAAU,MAAM,QAAQL,CAAW,EACzC,IAAIM,EAASD,EAAW,IAAI,MAAML,EAAY,MAAM,EAAK,KAEzD,GAAIK,EACF,QAASE,EAAI,EAAGC,EAAIR,EAAY,OAAQO,EAAIC,EAAGD,IAC7CD,EAAOC,CAAC,EAAIP,EAAYO,CAAC,EAAE,QAC3BP,EAAYO,CAAC,EAAE,UAAU,SAAUE,EAAG,CACpCH,EAAOC,CAAC,EAAIE,EACZC,EAAQ,CAChB,CAAO,OAGHJ,EAASN,EAAY,QACrBA,EAAY,UAAU,SAAUS,EAAG,CACjCH,EAASG,EACTC,EAAQ,CACd,CAAK,EAGHA,EAAQ,EAER,SAASA,GAAU,CACjB,MAAMC,EAASV,EAAGK,CAAM,EACpBK,GAAUA,EAAO,KAAMA,EAAO,KAAKP,CAAQ,EAC1CA,EAASO,CAAM,CACrB,CAED,OAAOT,CACT"}