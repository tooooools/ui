{"version":3,"file":"Backdrop-0a11c5cc.js","sources":["../../lib/components/Backdrop.jsx"],"sourcesContent":["import style from './Backdrop.module.scss'\n\nimport { Component } from '../jsx'\n\nimport noop from '../utils/noop'\nimport classnames from 'classnames'\n\nexport default class Backdrop extends Component {\n  beforeRender (props) {\n    this.close = this.close.bind(this)\n    this.captureEscapeKey = this.captureEscapeKey.bind(this)\n\n    this.state = {\n      lastActiveElement: document.activeElement\n    }\n  }\n\n  template (props, state) {\n    return (\n      <div\n        id={props.id}\n        class={classnames(style.backdrop, props.class)}\n        event-click={e => (props['event-click'] ?? noop)(e, this)}\n      >\n        {props.children}\n      </div>\n    )\n  }\n\n  afterMount () {\n    if (this.state.lastActiveElement) this.state.lastActiveElement.blur()\n    window.addEventListener('keyup', this.captureEscapeKey)\n    ;(this.props['event-open'] ?? noop)(null, this)\n  }\n\n  captureEscapeKey (e) {\n    if (e.key !== 'Escape') return\n    this.close()\n  }\n\n  close () {\n    ;(this.props['event-close'] || noop)(null, this)\n    this.destroy()\n  }\n\n  beforeDestroy () {\n    if (this.destroyed) return\n    window.removeEventListener('keyup', this.captureEscapeKey)\n\n    if (this.state && this.state.lastActiveElement) {\n      // Store element inside the closure so that there is no reference error\n      // when calling the timeout after having destroyed the component\n      const el = this.state.lastActiveElement\n      window.setTimeout(() => el.focus(), 0)\n    }\n  }\n}\n"],"names":["Backdrop","Component","props","state","h","classnames","style","e","noop","el"],"mappings":"4IAOA,MAAqBA,UAAiBC,CAAU,CAC9C,aAAcC,EAAO,CACnB,KAAK,MAAQ,KAAK,MAAM,KAAK,IAAI,EACjC,KAAK,iBAAmB,KAAK,iBAAiB,KAAK,IAAI,EAEvD,KAAK,MAAQ,CACX,kBAAmB,SAAS,aAAA,CAEhC,CAEA,SAAUA,EAAOC,EAAO,CAEpB,OAAAC,EAAC,MAAA,CACC,GAAIF,EAAM,GACV,MAAOG,EAAWC,EAAM,SAAUJ,EAAM,KAAK,EAC7C,cAAmBK,IAAAL,EAAM,aAAa,GAAKM,GAAMD,EAAG,IAAI,CAAA,EAEvDL,EAAM,QAAA,CAGb,CAEA,YAAc,CACR,KAAK,MAAM,mBAAwB,KAAA,MAAM,kBAAkB,OACxD,OAAA,iBAAiB,QAAS,KAAK,gBAAgB,GACpD,KAAK,MAAM,YAAY,GAAKM,GAAM,KAAM,IAAI,CAChD,CAEA,iBAAkB,EAAG,CACf,EAAE,MAAQ,UACd,KAAK,MAAM,CACb,CAEA,OAAS,EACL,KAAK,MAAM,aAAa,GAAKA,GAAM,KAAM,IAAI,EAC/C,KAAK,QAAQ,CACf,CAEA,eAAiB,CACf,GAAI,MAAK,YACF,OAAA,oBAAoB,QAAS,KAAK,gBAAgB,EAErD,KAAK,OAAS,KAAK,MAAM,mBAAmB,CAGxC,MAAAC,EAAK,KAAK,MAAM,kBACtB,OAAO,WAAW,IAAMA,EAAG,QAAS,CAAC,CACvC,CACF,CACF"}