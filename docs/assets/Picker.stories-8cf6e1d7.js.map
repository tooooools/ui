{"version":3,"file":"Picker.stories-8cf6e1d7.js","sources":["../../lib/state/derived.js","../../node_modules/iconoir/icons/nav-arrow-right.svg?raw","../../node_modules/iconoir/icons/nav-arrow-left.svg?raw","../../lib/components/Picker.jsx"],"sourcesContent":["import { Writable } from './writable'\n\nfunction derived (observables, cb) {\n  const value = new Writable()\n\n  const setValue = value.set.bind(value)\n  delete value.set\n\n  const isArray = Array.isArray(observables)\n  let values = isArray ? (new Array(observables.length)) : null\n\n  if (isArray) {\n    for (let i = 0, l = observables.length; i < l; i++) {\n      values[i] = observables[i].current\n      observables[i].subscribe(function (v) {\n        values[i] = v\n        derive()\n      })\n    }\n  } else {\n    values = observables.current\n    observables.subscribe(function (v) {\n      values = v\n      derive()\n    })\n  }\n\n  derive()\n\n  function derive () {\n    const result = cb(values)\n    if (result && result.then) result.then(setValue)\n    else setValue(result)\n  }\n\n  return value\n}\n\nexport default derived\n","export default \"<svg width=\\\"24\\\" height=\\\"24\\\" stroke-width=\\\"1.5\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\">\\n<path d=\\\"M9 6L15 12L9 18\\\" stroke=\\\"currentColor\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\"/>\\n</svg>\\n\"","export default \"<svg width=\\\"24\\\" height=\\\"24\\\" stroke-width=\\\"1.5\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\">\\n<path d=\\\"M15 6L9 12L15 18\\\" stroke=\\\"currentColor\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\"/>\\n</svg>\\n\"","import style from './Picker.module.scss'\n\nimport { Component } from '../jsx'\nimport { derived, ensure, writable } from '../state'\n\nimport noop from '../utils/noop'\nimport classnames from 'classnames'\n\nimport IconOpen from 'iconoir/icons/nav-arrow-right.svg?raw'\nimport IconClose from 'iconoir/icons/nav-arrow-left.svg?raw'\nimport Button from './Button'\nimport Toolbar from './Toolbar'\n\nexport default class Picker extends Component {\n  beforeRender (props) {\n    this.handleToggle = this.handleToggle.bind(this)\n\n    // Setup a ref for all children <Button> and decorate their event-click\n    const buttons = props.children.filter(child => child.type === Button)\n    for (const button of buttons) {\n      button.props.ref = this.refArray('buttons')\n      button.props['event-click'] = this.handleChange(\n        buttons.indexOf(button),\n        button.props['event-click'] || noop\n      )\n    }\n\n    this.state = {\n      label: ensure(writable)(props['store-label'], props.label),\n      title: ensure(writable)(props['store-title'], props.title),\n\n      open: ensure(writable)(props['store-open'], props.open),\n      disabled: ensure(writable)(props['store-disabled'], props.disabled),\n      hidden: ensure(writable)(props['store-hidden'], props.hidden)\n    }\n\n    this.state.toggleIcon = derived(this.state.open, () => {\n      return this.state.open.current ? IconOpen : IconClose\n    })\n  }\n\n  template (props, state) {\n    return (\n      <div\n        id={props.id}\n        class={classnames(style.picker, props.class)}\n        store-class-is-open={state.open}\n        store-class-is-disabled={state.disabled}\n        store-class-is-hidden={state.hidden}\n        event-mouseenter={e => (props['event-mouseenter'] ?? noop)(e, this)}\n        event-mouseleave={e => (props['event-mouseleave'] ?? noop)(e, this)}\n      >\n        <Toolbar\n          class={style.picker__toolbar}\n          compact\n        >\n          {props.children}\n        </Toolbar>\n\n        <Button\n          class={style.picker__toggle}\n          store-icon={state.toggleIcon}\n          store-label={state.label}\n          store-title={state.title}\n          event-click={this.handleToggle}\n        />\n      </div>\n    )\n  }\n\n  handleToggle () {\n    this.state.open.update(s => !s)\n  }\n\n  handleChange (i, callback) {\n    return async e => {\n      // Update all buttons active state\n      for (let index = 0; index < this.refs.buttons.length; index++) {\n        this.refs.buttons[index].state.active.set(index === i)\n      }\n\n      this.state.open.set(false)\n      ;(this.props['event-change'] ?? noop)(null, this)\n\n      await callback(e, this.refs.buttons[i])\n    }\n  }\n}\n"],"names":["derived","observables","cb","value","Writable","setValue","isArray","values","l","v","derive","result","IconOpen","IconClose","Picker","Component","props","buttons","child","Button","button","noop","ensure","writable","state","h","classnames","style","e","Toolbar","s","i","callback","index"],"mappings":"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","x_google_ignoreList":[1,2]}