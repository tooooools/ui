"use strict";function a(i,t,s,e){this.fn=t,this.ctx=s||null,this.owner=i,this.once=!!e}function c(i,t){t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),t.ctx=t.fn=t.owner=null,t===i._first&&(i._first=t.next),t===i._last&&(i._last=t.prev)}class h{constructor(){this._first=this._last=null,this._symbol=Symbol("signal")}dispatch(t,s,e,n,l){let u=this._first;for(;u;)u.fn.call(u.ctx,t,s,e,n,l),u.once&&this.unsubscribe(u),u=u.next}subscribe(t,s,e){const n=new a(this,t,s,e);return this._first?(this._last.next=n,n.prev=this._last,this._last=n):(this._first=n,this._last=n),n}subscribeOnce(t,s){return this.subscribe(t,s,!0)}unsubscribe(t,s){if(t instanceof a)return c(this,t);s||(s=null);let e=this._first;for(;e;)e.fn===t&&e.ctx===s&&c(this,e),e=e.next}unsubscribeAll(){let t=this._first;for(this._first=this._last=null;t;)c(this,t),t=t.next}}function d(){return new h}class o extends h{constructor(t){super(),this.initial=t,this.current=t}set(){throw new Error("Cannot set a different value for a Readable Signal. Use Writable instead")}get(){return this.current}}function x(i){return new o(i)}class f extends o{constructor(t){super(t),this.toggle=this.toggle.bind(this),this.reset=this.reset.bind(this)}set(t,s){if(!s&&this.current===t)return;this.previous=this.current,this.current=t;let e=this._first;for(;e;)e.fn.call(e.ctx,this.current,this.previous),e.once&&this.unsubscribe(e),e=e.next}reset(){this.set(this.initial)}toggle(){this.set(!this.current)}update(t,s){const e=t(this.current);this.set(e!==void 0?e:this.current,s)}}function g(i){return new f(i)}function w(i,t){const s=new f,e=s.set.bind(s);delete s.set;const n=Array.isArray(i);let l=n?new Array(i.length):null;if(n)for(let r=0,b=i.length;r<b;r++)l[r]=i[r].current,i[r].subscribe(function(_){l[r]=_,u()});else l=i.current,i.subscribe(function(r){l=r,u()});u();function u(){const r=t(l);r&&r.then?r.then(e):e(r)}return s}const p=i=>(...t)=>{for(const s of t){if(s instanceof h)return s;if(s!==void 0)return i(s)}return i(null)};exports.Writable=f;exports.derived=w;exports.ensure=p;exports.readable=x;exports.signal=d;exports.writable=g;
//# sourceMappingURL=ensure-84e7c7db.cjs.map
